{"version":3,"sources":["../lib/docor.js"],"names":["fetchLicenses","createFile","sys","require","resolve","__dirname","templates","license","toString","toLowerCase","readFileSync","join","e","filename","callback","cwd","process","pkg","locals","Date","getFullYear","indexOf","name","parsedName","parseName","main","apis","err","writeFile","substr","str","token","split","length","i","index","charAt","toUpperCase"],"mappings":";;;;;QAOgBA,a,GAAAA,a;QAeAC,U,GAAAA,U;;AAtBhB;;;;AACA;;;;AACA;;;;;;AAEA,MAAMC,MAAMC,QAAQ,eAAKC,OAAL,CAAaC,SAAb,EAAwB,iBAAxB,CAAR,CAAZ;AACA,MAAMC,YAAY,eAAKF,OAAL,CAAaC,SAAb,EAAwB,cAAxB,CAAlB;;AAEO,SAASL,aAAT,CAAuBO,OAAvB,EAAgC;AACrC,MAAI,CAACA,OAAL,EACE,OAAO,IAAP;;AAEFA,YAAUA,QAAQC,QAAR,GAAmBC,WAAnB,EAAV;;AAEA,MAAI;AACF,WAAO,aAAGC,YAAH,CACL,eAAKC,IAAL,CAAUL,SAAV,EAAqB,UAArB,EAAiCC,OAAjC,CADK,CAAP;AAGD,GAJD,CAIE,OAAOK,CAAP,EAAU;AACV,WAAO,IAAP;AACD;AACF;;AAEM,SAASX,UAAT,CAAoBY,QAApB,EAA8BC,QAA9B,EAAwC;AAC7C,MAAIC,MAAMC,QAAQD,GAAR,EAAV;AACA,MAAIE,MAAMd,QAAQ,eAAKQ,IAAL,CAAUI,GAAV,EAAe,cAAf,CAAR,CAAV;;AAEA,MAAIG,SAAS;AACXD,OADW;AAEXf,OAFW;AAGX,YAAQ,IAAIiB,IAAJ,GAAWC,WAAX,EAHG;AAIX,YAAQ;AAJG,GAAb;;AAOA,MAAIP,SAASQ,OAAT,CAAiB,QAAjB,IAA6B,CAAC,CAA9B,IAAmCR,SAASQ,OAAT,CAAiB,SAAjB,IAA8B,CAAC,CAAtE,EACEH,OAAOX,OAAP,GAAiBP,cAAciB,IAAIV,OAAlB,CAAjB;;AAEF,MAAIU,IAAIK,IAAR,EACEL,IAAIM,UAAJ,GAAiBC,UAAUP,IAAIK,IAAd,CAAjB;;AAEF,MAAIJ,OAAOX,OAAX,EACEW,OAAOX,OAAP,GAAiBW,OAAOX,OAAP,CAAeC,QAAf,EAAjB;;AAEF,MAAIS,IAAIQ,IAAR,EAAc;AACZ,QAAI;AACFP,aAAOQ,IAAP,GAAcvB,QAAQ,eAAKQ,IAAL,CAAUI,GAAV,EAAeE,IAAIQ,IAAnB,CAAR,CAAd;AACD,KAFD,CAEE,OAAOE,GAAP,EAAY;AACZ;AACD;AACF;;AAED,SAAO,aAAGC,SAAH,CACL,eAAKjB,IAAL,CAAUI,GAAV,EAAeF,QAAf,CADK,EAEL,sBAAOA,SAASQ,OAAT,CAAiB,GAAjB,MAA0B,CAA1B,GAA8BR,SAASgB,MAAT,CAAgB,CAAhB,CAA9B,GAAmDhB,QAA1D,EAAoEK,MAApE,CAFK,EAGLJ,QAHK,CAAP;AAKD;;AAED,SAASU,SAAT,CAAmBM,GAAnB,EAAwB;AACtB,MAAIA,IAAIT,OAAJ,CAAY,GAAZ,MAAqB,CAAzB,EACE,OAAOS,GAAP;;AAEF,MAAIC,QAAQD,IAAIE,KAAJ,CAAU,GAAV,CAAZ;;AAEA,MAAI,CAACD,MAAME,MAAX,EACE,OAAOH,GAAP;;AAEF,OAAK,IAAII,IAAIH,MAAME,MAAN,GAAe,CAA5B,EAA+BC,KAAK,CAApC,EAAuCA,GAAvC,EAA4C;AAC1C,KAAEC,KAAD,IAAW;AACV,UAAIA,UAAU,CAAd,EACE;;AAEFJ,YAAMI,KAAN,IAAeJ,MAAMI,KAAN,EAAaC,MAAb,CAAoB,CAApB,EAAuBC,WAAvB,KAAuCN,MAAMI,KAAN,EAAaN,MAAb,CAAoB,CAApB,CAAtD;AACD,KALD,EAKGK,CALH;AAMD;;AAED,SAAOH,MAAMpB,IAAN,CAAW,EAAX,CAAP;AACD","file":"docor.js","sourcesContent":["import fs from 'fs'\nimport path from 'path'\nimport render from './render'\n\nconst sys = require(path.resolve(__dirname, '../package.json'));\nconst templates = path.resolve(__dirname, '../templates');\n\nexport function fetchLicenses(license) {\n  if (!license)\n    return null\n\n  license = license.toString().toLowerCase()\n\n  try {\n    return fs.readFileSync(\n      path.join(templates, 'licenses', license)\n    )\n  } catch (e) {\n    return null\n  }\n}\n\nexport function createFile(filename, callback) {\n  var cwd = process.cwd()\n  var pkg = require(path.join(cwd, 'package.json'))\n\n  var locals = {\n    pkg,\n    sys,\n    'year': new Date().getFullYear(),\n    'apis': null,\n  }\n\n  if (filename.indexOf('README') > -1 || filename.indexOf('LICENSE') > -1)\n    locals.license = fetchLicenses(pkg.license)\n\n  if (pkg.name)\n    pkg.parsedName = parseName(pkg.name)\n\n  if (locals.license)\n    locals.license = locals.license.toString()\n\n  if (pkg.main) {\n    try {\n      locals.apis = require(path.join(cwd, pkg.main))\n    } catch (err) {\n      // just ignore the error\n    }\n  }\n\n  return fs.writeFile(\n    path.join(cwd, filename),\n    render(filename.indexOf('.') === 0 ? filename.substr(1) : filename)(locals),\n    callback\n  )\n}\n\nfunction parseName(str) {\n  if (str.indexOf('-') === 0)\n    return str\n\n  var token = str.split('-')\n\n  if (!token.length)\n    return str\n\n  for (var i = token.length - 1; i >= 0; i--) {\n    ((index) => {\n      if (index === 0)\n        return\n\n      token[index] = token[index].charAt(0).toUpperCase() + token[index].substr(1)\n    })(i);\n  }\n\n  return token.join('')\n}\n"]}